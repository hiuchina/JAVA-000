## 学习笔记

本周重点学习了分库分表，还有分布式事务。事务类型包括：XA，TCC ，TAC，BASE。

完成了第15课作业，用sharding-proxy，实现了分库分表。

数据库2个，每个库16张表。

- 因为16/2余数为0，如果按订单ID来分库，会导致奇数ID的全部到一个数据库(order_db_1)，偶数ID到全部熬一个数据库（order_db_0）,所以我配置sharding-proxy采用了数据库分片算法不按订单ID而是用户ID，这样可以保障16张表都有数据。

- 在数据分片到16个表的过程中，我发现雪花算法生成的ID都是16的倍数，每次都到tb_order_0,我在java里insert订单的时候，在雪花算法生成的ID后面加了一个（1～16）的随机数，让订单ID不是永远可以被16整除，不知道是否还有其他办法？

或许，我应该换种思路，比如16个表，是按用户ID来分，数据库按订单号的奇数和偶数分。